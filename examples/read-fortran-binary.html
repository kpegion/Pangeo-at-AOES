

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Read Fortran Binary Data Files &mdash; Pangeo-at-AOES 0.1.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Analysis using Xarray" href="advanced-analysis.html" />
    <link rel="prev" title="Read a file from an remote OPeNDAP server and make a contour plot of the data" href="read-opendap.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Pangeo-at-AOES
          

          
            
            <img src="../_static/AOES-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Prerequisites</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../prereq.html">What you should know</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prereq.html#data-access">Data Access</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../why-python-and-pangeo.html">Why Python?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../why-python-and-pangeo.html#what-is-pangeo">What is Pangeo?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setting-up-pangeo.html">Setting up Pangeo &amp; other Python Packages on the COLA Servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setting-up-jupyter.html">Setting up Jupyter on COLA Servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setting-up-jupyter.html#troubleshooting">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Reading Data</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="read-netcdf.html">Read a netcdf file and make a contour plot of the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="read-grib.html">Read a grib file and make a contour plot of the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="read-opendap.html">Read a file from an remote OPeNDAP server and make a contour plot of the data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Read Fortran Binary Data Files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Data">Data</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Climate Data Analysis Xarray</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="advanced-analysis.html">Analysis using <code class="docutils literal notranslate"><span class="pre">Xarray</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Plotting using Matplotlib</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="matplotlib-tutorial.html">Making Plots Using <code class="docutils literal notranslate"><span class="pre">Matplotlib</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Maps using Cartopy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cartopy-tutorial.html">Making Maps using <code class="docutils literal notranslate"><span class="pre">Cartopy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="multi-panel-cartopy.html">Making multi-panel plots using <code class="docutils literal notranslate"><span class="pre">Cartopy</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Hindcasts with climpred</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about-climpred.html">About climpred</a></li>
<li class="toctree-l1"><a class="reference internal" href="monthly-enso-subx-example.html">Calculate ENSO Skill as a Function of Initial Month vs. Lead Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="daily-subx-example.html">Calculate the skill of a MJO Index as a function of lead time</a></li>
</ul>
<p class="caption"><span class="caption-text">Weather Data with Metpy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../metpy-tutorial.html">About MetPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="metpy-constants-and-units.html">MetPy Constants and Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="metpy-calc.html">MetPy calc</a></li>
<li class="toctree-l1"><a class="reference internal" href="metpy-plot.html">MetPy Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="metpy-sounding-dignostic.html">Example 2: Analysis of ERA5 profiles</a></li>
</ul>
<p class="caption"><span class="caption-text">External Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../external.html">Why this External Tutorial?</a></li>
</ul>
<p class="caption"><span class="caption-text">Get Involved</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get-involved.html">AOES Python Club</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-involved.html#join-the-conversation-on-gitter">Join the Conversation on Gitter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-involved.html#identify-issues">Identify Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-involved.html#contribute-to-the-github-repository">Contribute to the Github Repository</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pangeo-at-AOES</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Read Fortran Binary Data Files</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/read-fortran-binary.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Read-Fortran-Binary-Data-Files">
<h1>Read Fortran Binary Data Files<a class="headerlink" href="#Read-Fortran-Binary-Data-Files" title="Permalink to this headline">¶</a></h1>
<p>Although most of the data files I work with in atmosphere, ocean, and climate science are in self describing formats, such as netCDF, grib, etc, I still sometimes encounter binary data files written in fortran direct or sequential access. I want to be able to read in these files and convert them to <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> so I can use all the <code class="docutils literal notranslate"><span class="pre">xarray</span></code> methods and tools to process them.</p>
<p>This notebook will demonstrate how to read a fortran binary sequential access file and convert it to an <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></p>
<p>Thanks to Phil Pegion at University of Colorado/CIRES and NOAA/PSL for showing me how to do this.</p>
<div class="section" id="Data">
<h2>Data<a class="headerlink" href="#Data" title="Permalink to this headline">¶</a></h2>
<p>I was given the location of the following file from a colleague (Thanks David Straus!). It consists of EOFs (spatial patterns of variability) based on anomalies of 500 hPa geopotential height and 250 hPa zonal winds. The file is located here on the COLA servers:</p>
<div class="highlight-/project/mjo/straus/erai_t42/eofs/djf/5day_means/eofs_z500u250_pna_djf_t42.1980-2014.dat``` notranslate"><div class="highlight"><pre><span></span>A [GrADS](http://cola.gmu.edu/grads/) .ctl file was provided with the data.  It has the important metadata that will be needed to know how to read the file.  Here are its contents:
</pre></div>
</div>
<p>dset /project/mjo/straus/ERAI_T42/eofs/DJF/5day_means/eofs_Z500U250_PNA_DJF_T42.1980-2014.dat undef -9999.9 title T42 gridded Minerva EOFs config Z500U250_PNA_DJF_T42 options sequential yrev xdef 128 linear 0.0 2.8125 ydef 64 LEVELS -87.86 -85.10 -82.31 -79.53 -76.74 -73.95 -71.16 -68.37 -65.58 -62.79 -60.00 -57.21 -54.42 -51.63 -48.84 -46.04 -43.25 -40.46 -37.67 -34.88 -32.09 -29.30 -26.51 -23.72 -20.93 -18.14 -15.35 -12.56 -9.77 -6.98 -4.19 -1.40 1.40 4.19 6.98 9.77 12.56 15.35 18.14
20.93 23.72 26.51 29.30 32.09 34.88 37.67 40.46 43.25 46.04 48.84 51.63 54.42 57.21 60.00 62.79 65.58 68.37 71.16 73.95 76.74 79.53 82.31 85.10 87.86 zdef 1 levels 1000 tdef 50 linear 01dec1980 1dy vars 2 geo 0 9 geo 500 uwn 0 9 geo 250 endvars ```</p>
<p>The key things to note from the .ctl file are: * lons = 128, start from 0.0 and increase in increments of 2.8125 * lats = 64 and are specified * the file has 50 “times”; these correspond to 50 EOFs * there are 2 variables in the file, geo (500 hPa geopotential height) and uwn (250 hPa zonal wind) * under options, it says sequential, so our file is sequential access. This means that each record has 2 extra INTEGER<a href="#id1"><span class="problematic" id="id2">*</span></a>4 in it. One at the beginning of the record and one at the end of the
record. * Missing data is indicated with values of -9999.9</p>
<p>The format of the data file is based on the format that GrADS expects, described [here (<a class="reference external" href="http://cola.gmu.edu/grads/gadoc/aboutgriddeddata.html#structure">http://cola.gmu.edu/grads/gadoc/aboutgriddeddata.html#structure</a>).</p>
<p>Each record is a grid of all lats and lons. The records are in the following order:</p>
<ol class="arabic simple">
<li><p>Time 1, geo</p></li>
<li><p>Time 1, uwn</p></li>
<li><p>Time 2, geo</p></li>
<li><p>Time 2, uwn</p></li>
<li><p>…</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">array</span> <span class="kn">import</span> <span class="n">array</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<p>Define the path and filename</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;/project/mjo/straus/ERAI_T42/eofs/DJF/5day_means/&#39;</span>
<span class="n">fname</span><span class="o">=</span><span class="s1">&#39;eofs_Z500U250_PNA_DJF_T42.1980-2014.dat&#39;</span>
</pre></div>
</div>
</div>
<p>Define the dimensions of the data based on the .ctl file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nlons</span><span class="o">=</span><span class="mi">128</span>
<span class="n">nlats</span><span class="o">=</span><span class="mi">64</span>
<span class="n">neofs</span><span class="o">=</span><span class="mi">50</span>
<span class="n">nvars</span><span class="o">=</span><span class="mi">2</span>
<span class="n">missing_value</span><span class="o">=-</span><span class="mf">9999.9</span>
</pre></div>
</div>
</div>
<p>Define the coordinates of the data based on the .ctl file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Define lats</span>
<span class="n">lats</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">87.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">85.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">82.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">79.53</span><span class="p">,</span> <span class="o">-</span><span class="mf">76.74</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">71.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">68.37</span><span class="p">,</span> \
      <span class="o">-</span><span class="mf">65.58</span><span class="p">,</span> <span class="o">-</span><span class="mf">62.79</span><span class="p">,</span> <span class="o">-</span><span class="mf">60.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">57.21</span><span class="p">,</span> <span class="o">-</span><span class="mf">54.42</span><span class="p">,</span> <span class="o">-</span><span class="mf">51.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">48.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.04</span><span class="p">,</span> \
      <span class="o">-</span><span class="mf">43.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.46</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.88</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.30</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.72</span><span class="p">,</span> \
      <span class="o">-</span><span class="mf">20.93</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.77</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.98</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.19</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.40</span><span class="p">,</span> \
      <span class="mf">1.40</span><span class="p">,</span>   <span class="mf">4.19</span><span class="p">,</span>   <span class="mf">6.98</span><span class="p">,</span>   <span class="mf">9.77</span><span class="p">,</span>  <span class="mf">12.56</span><span class="p">,</span>  <span class="mf">15.35</span><span class="p">,</span>  <span class="mf">18.14</span><span class="p">,</span>  <span class="mf">20.93</span><span class="p">,</span> \
      <span class="mf">23.72</span><span class="p">,</span>  <span class="mf">26.51</span><span class="p">,</span>  <span class="mf">29.30</span><span class="p">,</span>  <span class="mf">32.09</span><span class="p">,</span>  <span class="mf">34.88</span><span class="p">,</span>  <span class="mf">37.67</span><span class="p">,</span>  <span class="mf">40.46</span><span class="p">,</span>  <span class="mf">43.25</span><span class="p">,</span> \
      <span class="mf">46.04</span><span class="p">,</span>  <span class="mf">48.84</span><span class="p">,</span>  <span class="mf">51.63</span><span class="p">,</span>  <span class="mf">54.42</span><span class="p">,</span>  <span class="mf">57.21</span><span class="p">,</span>  <span class="mf">60.00</span><span class="p">,</span>  <span class="mf">62.79</span><span class="p">,</span>  <span class="mf">65.58</span><span class="p">,</span> \
      <span class="mf">68.37</span><span class="p">,</span>  <span class="mf">71.16</span><span class="p">,</span>  <span class="mf">73.95</span><span class="p">,</span>  <span class="mf">76.74</span><span class="p">,</span>  <span class="mf">79.53</span><span class="p">,</span>  <span class="mf">82.31</span><span class="p">,</span>  <span class="mf">85.10</span><span class="p">,</span>  <span class="mf">87.86</span><span class="p">]</span>

<span class="c1"># Yrev in .ctl file indicates lats are reversed</span>
<span class="n">lats</span><span class="o">=</span><span class="n">lats</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Define lons</span>
<span class="n">lons</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="o">*</span><span class="mf">2.8125</span> <span class="o">+</span> <span class="mf">0.0</span>

<span class="c1"># Define times as a pandas date range</span>
<span class="n">eofs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">neofs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Define the length of each record. Be sure to include the 2 extra integers for sequential access.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">recl</span><span class="o">=</span><span class="p">(</span><span class="n">nlons</span><span class="o">*</span><span class="n">nlats</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
</pre></div>
</div>
</div>
<p>Create empty array to store the data</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">neofs</span><span class="p">,</span><span class="n">nlats</span><span class="p">,</span><span class="n">nlons</span><span class="p">,</span><span class="n">nvars</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Read the data</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Open file</span>
<span class="n">luin</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="n">fname</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>

<span class="c1"># Loop over all times</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neofs</span><span class="p">):</span>

    <span class="c1"># Loop over both variables</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvars</span><span class="p">):</span>

        <span class="c1"># Read in fortran record in bytes</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">luin</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">recl</span><span class="p">)</span>

        <span class="c1"># Convert to single precision (real 32bit)</span>
        <span class="n">tmp1</span><span class="o">=</span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="n">tmp</span><span class="p">)</span>

        <span class="c1"># Pull out data array (leaving behind fortran control records)for fortran sequential</span>
        <span class="n">tmp2</span><span class="o">=</span><span class="n">tmp1</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Create a 2d array (lat x lon) and store it in the data array</span>
        <span class="n">data</span><span class="p">[</span><span class="n">e</span><span class="p">,:,:,</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tmp2</span><span class="p">,(</span><span class="n">nlats</span><span class="p">,</span><span class="n">nlons</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Extract out our two variables</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">z500</span><span class="o">=</span><span class="n">data</span><span class="p">[:,:,:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">u250</span><span class="o">=</span><span class="n">data</span><span class="p">[:,:,:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Take care of missing data by setting it to NAN</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">z500</span><span class="p">[</span><span class="n">z500</span><span class="o">&lt;=</span><span class="n">missing_value</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">u250</span><span class="p">[</span><span class="n">u250</span><span class="o">&lt;=</span><span class="n">missing_value</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
<p>Put the data into an <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># 500 hPa Geopotential Height</span>
<span class="n">z500_ds</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">z500</span><span class="p">,</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;eofnum&#39;</span><span class="p">:</span><span class="n">eofs</span><span class="p">,</span>
                        <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">lats</span><span class="p">,</span>
                        <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="n">lons</span><span class="p">},</span>
                        <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eofnum&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>
<span class="n">z500_ds</span><span class="o">=</span><span class="n">z500_ds</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;z500&#39;</span><span class="p">)</span>

<span class="c1"># 250 hPa Zonal Wind</span>
<span class="n">u250_ds</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">u250</span><span class="p">,</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;eofnum&#39;</span><span class="p">:</span><span class="n">eofs</span><span class="p">,</span>
                        <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">lats</span><span class="p">,</span>
                        <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="n">lons</span><span class="p">},</span>
                        <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eofnum&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>
<span class="n">u250_ds</span><span class="o">=</span><span class="n">u250_ds</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;u250&#39;</span><span class="p">)</span>

<span class="c1"># Merge to have both in the same `xarray.Dataset`</span>
<span class="n">ds</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">z500_ds</span><span class="p">,</span><span class="n">u250_ds</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>This dataset has global values, but only contains valid data in a certain region. All other values are marked as missing. So, we will drop missing data for <code class="docutils literal notranslate"><span class="pre">lat</span></code> and <code class="docutils literal notranslate"><span class="pre">lon</span></code> where <code class="docutils literal notranslate"><span class="pre">all</span></code> the data are missing.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we have an <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> with both variables in it</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<title>Show/Hide data repr</title>
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<title>Show/Hide attributes</title>
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

.xr-wrap {
  min-width: 300px;
  max-width: 700px;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><div class='xr-wrap'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-eb1b4fc3-571f-4af6-8004-37d232ce8fd5' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-eb1b4fc3-571f-4af6-8004-37d232ce8fd5' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>eofnum</span>: 50</li><li><span class='xr-has-index'>lat</span>: 22</li><li><span class='xr-has-index'>lon</span>: 55</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-a4742a50-b35e-4f55-9ae1-5c143a44e306' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a4742a50-b35e-4f55-9ae1-5c143a44e306' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>eofnum</span></div><div class='xr-var-dims'>(eofnum)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 44 45 46 47 48 49</div><input id='attrs-94f9ea1a-07a7-47e0-8e7f-0de398b9b9c0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-94f9ea1a-07a7-47e0-8e7f-0de398b9b9c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dde78939-9991-4482-a56d-353c3250b8d5' class='xr-var-data-in' type='checkbox'><label for='data-dde78939-9991-4482-a56d-353c3250b8d5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>79.53 76.74 73.95 ... 23.72 20.93</div><input id='attrs-abbc14ad-9120-4dd8-924c-184fc4a9e0eb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-abbc14ad-9120-4dd8-924c-184fc4a9e0eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0df38bf6-21ad-4503-8eae-73371e874adf' class='xr-var-data-in' type='checkbox'><label for='data-0df38bf6-21ad-4503-8eae-73371e874adf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([79.53, 76.74, 73.95, 71.16, 68.37, 65.58, 62.79, 60.  , 57.21, 54.42,
       51.63, 48.84, 46.04, 43.25, 40.46, 37.67, 34.88, 32.09, 29.3 , 26.51,
       23.72, 20.93])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>149.1 151.9 154.7 ... 298.1 300.9</div><input id='attrs-5c757cc3-6056-4292-a025-11247998e39f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5c757cc3-6056-4292-a025-11247998e39f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a525bb89-945f-4dbb-a792-99e29ad9b27b' class='xr-var-data-in' type='checkbox'><label for='data-a525bb89-945f-4dbb-a792-99e29ad9b27b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([149.0625, 151.875 , 154.6875, 157.5   , 160.3125, 163.125 , 165.9375,
       168.75  , 171.5625, 174.375 , 177.1875, 180.    , 182.8125, 185.625 ,
       188.4375, 191.25  , 194.0625, 196.875 , 199.6875, 202.5   , 205.3125,
       208.125 , 210.9375, 213.75  , 216.5625, 219.375 , 222.1875, 225.    ,
       227.8125, 230.625 , 233.4375, 236.25  , 239.0625, 241.875 , 244.6875,
       247.5   , 250.3125, 253.125 , 255.9375, 258.75  , 261.5625, 264.375 ,
       267.1875, 270.    , 272.8125, 275.625 , 278.4375, 281.25  , 284.0625,
       286.875 , 289.6875, 292.5   , 295.3125, 298.125 , 300.9375])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-f9ffdbc5-9c15-4f44-baff-6f2a5c02afc0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f9ffdbc5-9c15-4f44-baff-6f2a5c02afc0' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>z500</span></div><div class='xr-var-dims'>(eofnum, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.002158 -0.002206 ... 0.02562</div><input id='attrs-ff0c8621-0dc0-4c88-a38c-3403569cff3c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ff0c8621-0dc0-4c88-a38c-3403569cff3c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a8782939-2e29-4fc4-8441-9c730e7161cd' class='xr-var-data-in' type='checkbox'><label for='data-a8782939-2e29-4fc4-8441-9c730e7161cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[[-0.002158  , -0.00220595, -0.00228811, ...,  0.00327728,
          0.00300202,  0.00273191],
        [-0.00108383, -0.00128649, -0.00155361, ...,  0.00501033,
          0.00468588,  0.00440384],
        [-0.00026226, -0.00073544, -0.00130028, ...,  0.00727348,
          0.00694905,  0.00672204],
        ...,
        [ 0.00074248,  0.00130832,  0.00190614, ..., -0.0083919 ,
         -0.00664706, -0.00494827],
        [ 0.00231581,  0.00295281,  0.00362799, ..., -0.00347408,
         -0.00200538, -0.00059551],
        [ 0.00294929,  0.00352495,  0.00414385, ...,  0.00032963,
          0.00150379,  0.00257015]],

       [[ 0.02804737,  0.02952897,  0.03100066, ...,  0.00897593,
          0.00889765,  0.00883475],
        [ 0.03061595,  0.03248763,  0.03436497, ...,  0.00791413,
          0.00814203,  0.00835402],
        [ 0.03187996,  0.03406161,  0.03627764, ...,  0.00662772,
          0.00719402,  0.00768509],
        ...,
        [-0.01016358, -0.01049233, -0.0109251 , ...,  0.00520642,
          0.00627226,  0.00718058],
        [-0.00729834, -0.00732004, -0.00740464, ...,  0.0050148 ,
          0.00580437,  0.00641984],
        [-0.00459142, -0.00439604, -0.00423954, ...,  0.00432985,
          0.00484394,  0.0052273 ]],

       [[ 0.00612653,  0.00697537,  0.00784884, ...,  0.02855317,
          0.02793981,  0.0272431 ],
        [ 0.00512187,  0.00622983,  0.00738804, ...,  0.03207463,
          0.03138904,  0.03061321],
        [ 0.00410869,  0.00556858,  0.00711428, ...,  0.03529465,
          0.03467516,  0.03395033],
        ...,
        [-0.00271158, -0.00279433, -0.00307642, ..., -0.0118286 ,
         -0.01089127, -0.00978137],
        [-0.0045    , -0.00489188, -0.00544718, ..., -0.00718506,
         -0.00629644, -0.00534736],
        [-0.00458211, -0.00515804, -0.00583121, ..., -0.00363517,
         -0.00283486, -0.00202041]],

       ...,

       [[-0.01864509, -0.01075046, -0.00266998, ...,  0.04010107,
          0.04090822,  0.04174188],
        [-0.05606855, -0.04493044, -0.03325174, ...,  0.03202585,
          0.03159026,  0.03131655],
        [-0.08085682, -0.06702159, -0.05223473, ...,  0.02522704,
          0.02314838,  0.02118093],
        ...,
        [ 0.02627099,  0.02653411,  0.02628059, ...,  0.00544976,
          0.00259615,  0.00035392],
        [ 0.02030761,  0.02021568,  0.01993696, ...,  0.00059026,
         -0.0018854 , -0.00314069],
        [ 0.01401448,  0.01381945,  0.01367958, ..., -0.00225147,
         -0.00419645, -0.00532932]],

       [[ 0.04751408,  0.04561215,  0.04331871, ..., -0.00338019,
         -0.00301781, -0.00286037],
        [ 0.06166209,  0.05696166,  0.05177492, ...,  0.0201336 ,
          0.02451151,  0.0284923 ],
        [ 0.07115426,  0.0632488 ,  0.05454243, ...,  0.03891129,
          0.04851751,  0.05747972],
        ...,
        [ 0.02097011,  0.02108839,  0.02070948, ..., -0.00358492,
         -0.00651896, -0.00976063],
        [ 0.01574826,  0.01597328,  0.01606623, ..., -0.00159008,
         -0.00374378, -0.00641956],
        [ 0.01074952,  0.01153862,  0.01228776, ..., -0.00168329,
         -0.00290302, -0.00454319]],

       [[-0.0435605 , -0.04174044, -0.04017138, ...,  0.01181326,
          0.00920507,  0.00700798],
        [-0.00962206, -0.00871575, -0.00828135, ...,  0.00396727,
          0.00270966,  0.00181388],
        [ 0.01499207,  0.01506878,  0.01479533, ...,  0.00439176,
          0.00604054,  0.00743839],
        ...,
        [ 0.01366874,  0.01115884,  0.00764642, ...,  0.02832497,
          0.03550598,  0.04137369],
        [ 0.01450719,  0.01236514,  0.00922952, ...,  0.02451376,
          0.02978178,  0.03393774],
        [ 0.01300429,  0.01168108,  0.00948214, ...,  0.01950187,
          0.02298067,  0.02562426]]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>u250</span></div><div class='xr-var-dims'>(eofnum, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.001532 0.001246 ... -0.01382</div><input id='attrs-819b06f3-3ad6-4432-abb9-26f6efac7277' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-819b06f3-3ad6-4432-abb9-26f6efac7277' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-83ee6621-95e0-4f7e-a173-3e22daf2b918' class='xr-var-data-in' type='checkbox'><label for='data-83ee6621-95e0-4f7e-a173-3e22daf2b918' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[[ 1.53196824e-03,  1.24586432e-03,  9.37075180e-04, ...,
          6.81354245e-03,  6.58087712e-03,  6.39861170e-03],
        [ 1.26479927e-03,  6.66564796e-04,  2.11234419e-05, ...,
          8.02088436e-03,  7.93377869e-03,  7.94643722e-03],
        [ 1.78612303e-04, -7.32205750e-04, -1.68895361e-03, ...,
          9.76998080e-03,  9.75693483e-03,  9.87682119e-03],
        ...,
        [ 3.72749264e-03,  3.31535260e-03,  3.01158777e-03, ...,
          3.34553272e-02,  3.23658995e-02,  3.10922600e-02],
        [ 6.10744406e-04, -5.86430833e-04, -1.63436146e-03, ...,
          2.82338019e-02,  2.65578907e-02,  2.45361514e-02],
        [-1.07795326e-03, -2.63791531e-03, -3.96567956e-03, ...,
          1.90932527e-02,  1.66952163e-02,  1.38983568e-02]],

       [[ 1.00594200e-02,  1.12567339e-02,  1.24731837e-02, ...,
         -3.62311769e-03, -2.97147152e-03, -2.32227636e-03],
        [ 8.11136235e-03,  9.27418191e-03,  1.04863551e-02, ...,
         -4.78920713e-03, -3.68509651e-03, -2.62138387e-03],
        [ 4.97528724e-03,  5.94995404e-03,  7.01734098e-03, ...,
         -7.43465358e-03, -6.03462383e-03, -4.71026357e-03],
        ...,
        [ 1.62234008e-02,  1.70329642e-02,  1.82482880e-02, ...,
         -1.31671099e-04, -1.40730094e-03, -2.23548221e-03],
        [ 1.41241997e-02,  1.47185987e-02,  1.56279914e-02, ...,
         -5.68011869e-03, -7.20053446e-03, -8.12136848e-03],
        [ 1.13609452e-02,  1.16782486e-02,  1.21250292e-02, ...,
         -9.37343389e-03, -1.12014730e-02, -1.26279639e-02]],

       [[ 5.09383040e-04,  1.29347155e-03,  2.09772983e-03, ...,
          1.21854078e-02,  1.20889908e-02,  1.18973004e-02],
        [-3.26130103e-05,  9.23476007e-04,  1.93817867e-03, ...,
          1.22913644e-02,  1.25519698e-02,  1.27273453e-02],
        [-5.42328809e-04,  6.01720414e-04,  1.84066058e-03, ...,
          1.15508195e-02,  1.21098235e-02,  1.25962971e-02],
        ...,
        [ 7.66455848e-03,  6.53720181e-03,  5.07525913e-03, ...,
          3.00171692e-02,  3.08416262e-02,  3.11397780e-02],
        [ 1.31286019e-02,  1.30052613e-02,  1.28297415e-02, ...,
          3.02441884e-02,  3.00411005e-02,  2.93272361e-02],
        [ 1.56389531e-02,  1.62307527e-02,  1.68851018e-02, ...,
          2.49920674e-02,  2.42295861e-02,  2.30317246e-02]],

       ...,

       [[-7.12160170e-02, -6.53306171e-02, -5.89000285e-02, ...,
         -1.14088216e-04, -1.22301700e-03, -2.37001758e-03],
        [-4.89874184e-02, -4.24760096e-02, -3.52199897e-02, ...,
         -2.93661770e-03, -5.10399602e-03, -7.26001710e-03],
        [-1.08780088e-02, -4.85702697e-03,  1.81823678e-03, ...,
         -1.03401281e-02, -1.11119458e-02, -1.17218299e-02],
        ...,
        [-2.37228852e-02, -2.00150795e-02, -1.47998091e-02, ...,
         -3.04615218e-02, -3.48764658e-02, -4.01759148e-02],
        [-8.65714066e-03, -6.96240878e-03, -5.22414362e-03, ...,
         -1.07812416e-02, -1.70599930e-02, -2.31175795e-02],
        [-6.50559831e-03, -4.75029740e-03, -2.25897972e-03, ...,
          3.75310797e-03, -1.70688587e-03, -4.97795641e-03]],

       [[ 5.29689156e-02,  4.81081195e-02,  4.32048775e-02, ...,
          6.89526349e-02,  7.62244985e-02,  8.32419321e-02],
        [ 3.72534320e-02,  3.16580981e-02,  2.59131584e-02, ...,
          8.02049711e-02,  9.05841812e-02,  1.00608267e-01],
        [ 1.99556220e-02,  1.36172855e-02,  6.86939387e-03, ...,
          6.63188621e-02,  7.91637301e-02,  9.17789042e-02],
        ...,
        [-9.82709881e-03, -6.93462091e-03, -3.35136335e-03, ...,
         -3.82250622e-02, -3.13070156e-02, -2.07038224e-02],
        [-5.54733863e-03, -4.38756030e-03, -2.61910656e-03, ...,
         -7.21446276e-02, -6.06871732e-02, -4.43444364e-02],
        [-5.97783830e-03, -7.21936952e-03, -7.65510974e-03, ...,
         -6.61494285e-02, -5.45869619e-02, -3.94132882e-02]],

       [[ 6.16648011e-02,  6.04927838e-02,  5.89608960e-02, ...,
          2.50439486e-03,  2.16319901e-03,  2.11935118e-03],
        [ 6.20941110e-02,  6.10787347e-02,  5.98138869e-02, ...,
          4.89066541e-03,  6.79735607e-03,  8.60090461e-03],
        [ 2.95377690e-02,  2.76271030e-02,  2.61110347e-02, ...,
          1.57942995e-02,  1.97941288e-02,  2.30482370e-02],
        ...,
        [ 1.10309701e-02,  1.46572599e-02,  1.64470412e-02, ...,
          2.29242872e-02,  1.70561224e-02,  5.99110778e-03],
        [-1.02932882e-02, -1.30164074e-02, -1.45851653e-02, ...,
          2.29679886e-02,  1.35463998e-02,  1.58838506e-04],
        [-1.93685014e-02, -2.25512218e-02, -2.36124173e-02, ...,
          1.39191495e-02,  7.63459189e-04, -1.38242673e-02]]])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-5bce16b7-b928-4311-a43a-df29cc692c97' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5bce16b7-b928-4311-a43a-df29cc692c97' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<p>Let’s see what our data look like</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;z500&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:,:])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.contour.QuadContourSet at 0x7fb0c0872f28&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_read-fortran-binary_28_1.png" src="../_images/examples_read-fortran-binary_28_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;u250&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:,:])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.contour.QuadContourSet at 0x7fb0c086cc88&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_read-fortran-binary_29_1.png" src="../_images/examples_read-fortran-binary_29_1.png" />
</div>
</div>
<p>Write our data out to a netcdf file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;eofs.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="advanced-analysis.html" class="btn btn-neutral float-right" title="Analysis using Xarray" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="read-opendap.html" class="btn btn-neutral float-left" title="Read a file from an remote OPeNDAP server and make a contour plot of the data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Kathy Pegion

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>